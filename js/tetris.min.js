var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,h,k){if(k.get||k.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[h]=k.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(d){var h=0;return $jscomp.iteratorPrototype(function(){return h<d.length?{done:!1,value:d[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.makeIterator=function(d){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var h=d[Symbol.iterator];return h?h.call(d):$jscomp.arrayIterator(d)};
$jscomp.polyfill=function(d,h,k,m){if(h){k=$jscomp.global;d=d.split(".");for(m=0;m<d.length-1;m++){var n=d[m];n in k||(k[n]={});k=k[n]}d=d[d.length-1];m=k[d];h=h(m);h!=m&&null!=h&&$jscomp.defineProperty(k,d,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.from",function(d){return d?d:function(d,k,m){$jscomp.initSymbolIterator();k=null!=k?k:function(d){return d};var h=[],p=d[Symbol.iterator];if("function"==typeof p)for(d=p.call(d);!(p=d.next()).done;)h.push(k.call(m,p.value));else for(var p=d.length,l=0;l<p;l++)h.push(k.call(m,d[l]));return h}},"es6-impl","es3");
(function(){var d=950,h=!1,k=!1,m=!1,n=!1,p=!1,l="",f=1,q=0,C=window.randomIntFromInterval(0,6),v="",D=!0,E=!0,A=0,Y=document.getElementById("gameBoard"),G=Number(window.getCookie("tetrisHighScore")),t=d,e=[],u=function(){return Array.from(document.querySelectorAll(".moving"))},ba=function(a){switch(a.key){case "ArrowLeft":E&&J(-1);break;case "ArrowRight":E&&J(1);break;case " ":t=100;break;case "r":case "R":case "ArrowUp":if(!n||"sq"===l)break;Z();break;case "h":case "H":D&&(D=!1,K(),""===v?(v=l,
L(),H(!1,v)):(a=v,v=l,H(!0,a),L()));break;case "ArrowDown":n&&aa()}},M=function(a,b,c){document.getElementById(a+"-"+b).classList.add("moving");document.getElementById(a+"-"+b).classList.add(c);e[a][b]=1},w=function(a){return a.some(function(a){return 0>a[0]||9<a[0]||0>a[1]||19<a[1]||0!==e[a[0]][a[1]]})},x=function(a,b){a.forEach(function(a){M(a[0],a[1],b)})},Z=function(){var a=[];u().forEach(function(b){var c=$jscomp.makeIterator(r(b.id)),d=c.next().value,c=c.next().value;document.getElementById(d+
"-"+c).classList.remove("moving");e[d][c]=0;a.push([d,c]);B(b)});if("st"===l){var b=ca(a);if(w(b)){x(a,"cyan");return}y(b,"cyan")}else if("tt"===l){b=da(a);if(w(b)){x(a,"blue");return}y(b,"blue")}else if("rl"===l){b=ea(a);if(w(b)){x(a,"orange");return}y(b,"orange")}else if("ml"===l){b=fa(a);if(w(b)){x(a,"green");return}y(b,"green")}else if("rz"===l){b=ga(a);if(w(b)){x(a,"purple");return}y(b,"purple")}else if("mz"===l){b=ha(a);if(w(b)){x(a,"red");return}y(b,"red")}F()},y=function(a,b){f++;a.forEach(function(a){M(a[0],
a[1],b)});5===f&&(f=1)},ha=function(a){var b=[];1===f?(b.push([a[0][0]+1,a[0][1]-1]),b.push([a[1][0],a[1][1]-2]),b.push([a[2][0]+1,a[2][1]+1]),b.push([a[3][0],a[3][1]])):2===f?(b.push([a[0][0]+2,a[0][1]]),b.push([a[1][0]+1,a[1][1]+1]),b.push([a[2][0],a[2][1]]),b.push([a[3][0]-1,a[3][1]+1])):3===f?(b.push([a[0][0],a[0][1]]),b.push([a[1][0]-1,a[1][1]-1]),b.push([a[2][0],a[2][1]+2]),b.push([a[3][0]-1,a[3][1]+1])):4===f&&(b.push([a[0][0]+1,a[0][1]-1]),b.push([a[1][0],a[1][1]]),b.push([a[2][0]-1,a[2][1]-
1]),b.push([a[3][0]-2,a[3][1]]));return b},ga=function(a){var b=[];1===f?(b.push([a[0][0]+1,a[0][1]+1]),b.push([a[1][0],a[1][1]]),b.push([a[2][0]-1,a[2][1]+1]),b.push([a[3][0]-2,a[3][1]])):2===f?(b.push([a[0][0],a[0][1]-2]),b.push([a[1][0],a[1][1]]),b.push([a[2][0]-1,a[2][1]-1]),b.push([a[3][0]-1,a[3][1]+1])):3===f?(b.push([a[0][0]+2,a[0][1]]),b.push([a[1][0]+1,a[1][1]-1]),b.push([a[2][0],a[2][1]]),b.push([a[3][0]-1,a[3][1]-1])):4===f&&(b.push([a[0][0]+1,a[0][1]-1]),b.push([a[1][0]+1,a[1][1]+1]),
b.push([a[2][0],a[2][1]]),b.push([a[3][0],a[3][1]+2]));return b},fa=function(a){var b=[];1===f?(b.push([a[0][0]+1,a[0][1]-1]),b.push([a[1][0]+2,a[1][1]+2]),b.push([a[2][0]+1,a[2][1]+1]),b.push([a[3][0],a[3][1]])):2===f?(b.push([a[0][0]+1,a[0][1]+1]),b.push([a[1][0],a[1][1]]),b.push([a[2][0]-1,a[2][1]+1]),b.push([a[3][0]-2,a[3][1]+2])):3===f?(b.push([a[0][0],a[0][1]]),b.push([a[1][0]-1,a[1][1]-1]),b.push([a[2][0]-2,a[2][1]-2]),b.push([a[3][0]-1,a[3][1]+1])):4===f&&(b.push([a[0][0]+2,a[0][1]-2]),b.push([a[1][0]+
1,a[1][1]-1]),b.push([a[2][0],a[2][1]]),b.push([a[3][0]-1,a[3][1]-1]));return b},ea=function(a){var b=[];1===f?(b.push([a[0][0]+2,a[0][1]+2]),b.push([a[1][0]+1,a[1][1]+1]),b.push([a[2][0],a[2][1]]),b.push([a[3][0]-1,a[3][1]+1])):2===f?(b.push([a[0][0],a[0][1]]),b.push([a[1][0]-1,a[1][1]-1]),b.push([a[2][0]-1,a[2][1]+1]),b.push([a[3][0]-2,a[3][1]+2])):3===f?(b.push([a[0][0]+1,a[0][1]-1]),b.push([a[1][0],a[1][1]]),b.push([a[2][0]-1,a[2][1]-1]),b.push([a[3][0]-2,a[3][1]-2])):4===f&&(b.push([a[0][0]+
2,a[0][1]-2]),b.push([a[1][0]+1,a[1][1]-1]),b.push([a[2][0]+1,a[2][1]+1]),b.push([a[3][0],a[3][1]]));return b},da=function(a){var b=[];1===f?(b.push([a[0][0],a[0][1]]),b.push([a[1][0],a[1][1]]),b.push([a[2][0],a[2][1]]),b.push([a[3][0]+1,a[3][1]-1])):2===f?(b.push([a[0][0]+1,a[0][1]+1]),b.push([a[1][0],a[1][1]]),b.push([a[2][0],a[2][1]]),b.push([a[3][0],a[3][1]])):3===f?(b.push([a[0][0]-1,a[0][1]+1]),b.push([a[1][0],a[1][1]]),b.push([a[2][0],a[2][1]]),b.push([a[3][0],a[3][1]])):4===f&&(b.push([a[0][0],
a[0][1]]),b.push([a[1][0],a[1][1]]),b.push([a[2][0],a[2][1]]),b.push([a[3][0]-1,a[3][1]-1]));return b},ca=function(a){var b=[];1===f||3===f?(b.push([a[0][0]-1,a[0][1]+1]),b.push([a[1][0],a[1][1]]),b.push([a[2][0]+1,a[2][1]-1]),b.push([a[3][0]+2,a[3][1]-2])):(b.push([a[0][0]+1,a[0][1]-1]),b.push([a[1][0],a[1][1]]),b.push([a[2][0]-1,a[2][1]+1]),b.push([a[3][0]-2,a[3][1]+2]));return b},ia=function(a){" "===a.key&&(t=d)},J=function(a){var b=[],c=u();if(-1!==a||!c.some(function(a){return 0===Number(a.id.charAt(0))}))if(1!==
a||!c.some(function(a){return 9===Number(a.id.charAt(0))})){for(var g=$jscomp.makeIterator(c),d=g.next();!d.done;d=g.next()){var z=$jscomp.makeIterator(r(d.value.id)),d=z.next().value,z=z.next().value;if(2===e[d+a][z])return}c.forEach(function(a){var c=$jscomp.makeIterator(r(a.id));a=c.next().value;c=c.next().value;document.getElementById(a+"-"+c).classList.remove("moving");e[a][c]=0;b.push([a,c])});b.forEach(function(b){document.getElementById(b[0]+a+"-"+b[1]).classList.add("moving");N(document.getElementById(b[0]+
"-"+b[1]),document.getElementById(b[0]+a+"-"+b[1]),"moving");e[b[0]+a][b[1]]=1});F()}},ja=function(){k||(m=h=!0,O())},la=function(){for(var a=0,b=19;0<=b;b--){for(var c=0,g=0;10>g;g++)2===e[g][b]&&c++;if(10===c){c=b;for(g=0;10>g;g++)e[g][c]=0,document.getElementById(g+"-"+c).classList.remove("placed");c=b;for(g=19;0<=g;g--)for(var d=0;10>d;d++)if(!(g>c))if(g<=c&&0!==g){document.getElementById(d+"-"+g).classList.remove("placed");e[d][g]=e[d][g-1];var z=ka(d,g);2===e[d][g]&&(document.getElementById(d+
"-"+g).classList.add("placed"),document.getElementById(d+"-"+g).classList.add(z))}else document.getElementById(d+"-"+g).classList.remove("placed"),e[d][g]=0,B(document.getElementById(d+"-"+g));b++;a++}}switch(a){case 1:q+=40;break;case 2:q+=100;break;case 3:q+=300;break;case 4:q+=1200}document.getElementById("points").textContent=q},O=function(){m?(H(!1),E=D=!0,A++,20===A?t=d=850:35===A?t=d=750:55===A?t=d=600:110===A&&(t=d=400)):n&&(ma(),D=!1);p&&na();window.sleep(t).then(function(){h&&!k&&O()})},
P=function(a,b){for(var c=0;4>c;c++)document.getElementById(a+"-"+c+b).classList.add("cyan")},Q=function(a,b){for(var c=0;2>c;c++)document.getElementById(a+"-"+(c+1)+b).classList.add("yellow");for(c=0;2>c;c++)document.getElementById(a+1+"-"+(c+1)+b).classList.add("yellow")},R=function(a,b){for(var c=0;3>c;c++)document.getElementById(a+"-"+(c+1)+b).classList.add("orange");document.getElementById(a+1+"-3"+b).classList.add("orange")},S=function(a,b){for(var c=0;3>c;c++)document.getElementById(a+"-"+
(c+1)+b).classList.add("green");document.getElementById(a-1+"-3"+b).classList.add("green")},T=function(a,b){for(var c=0;3>c;c++)document.getElementById(a+"-"+(c+1)+b).classList.add("blue");document.getElementById(a-1+"-2"+b).classList.add("blue")},U=function(a,b){for(var c=0;2>c;c++)document.getElementById(a+"-"+(c+1)+b).classList.add("purple");for(c=0;2>c;c++)document.getElementById(a+1+"-"+(c+2)+b).classList.add("purple")},V=function(a,b){for(var c=0;2>c;c++)document.getElementById(a+"-"+(c+1)+
b).classList.add("red");for(c=0;2>c;c++)document.getElementById(a-1+"-"+(c+2)+b).classList.add("red")},K=function(){u().forEach(function(a){var b=$jscomp.makeIterator(r(a.id)),c=b.next().value,b=b.next().value;B(a);a.classList.remove("moving");e[c][b]=0})},L=function(){W("heldPeice");switch(v){case "st":P(1,"-h");break;case "sq":Q(1,"-h");break;case "rl":R(1,"-h");break;case "tt":T(2,"-h");break;case "ml":S(2,"-h");break;case "rz":U(1,"-h");break;case "mz":V(2,"-h")}},W=function(a){Array.from(document.getElementById(a).children).forEach(function(a){Array.from(a.children).forEach(function(a){return B(a)})})},
H=function(a,b){var c;if(a)c=b;else{c=C;do C=window.randomIntFromInterval(0,6);while(C===c);W("nextPeice");switch(C){case 0:P(1,"-n");break;case 1:Q(1,"-n");break;case 2:R(1,"-n");break;case 3:T(2,"-n");break;case 4:S(2,"-n");break;case 5:U(1,"-n");break;case 6:V(2,"-n")}}if(oa(c))k=!0,window.closableModal("Game Over!"),q>G&&(window.setCookie("tetrisHighScore",q,30),document.getElementById("highPoints").textContent=q);else{switch(c){case 0:case "st":for(c=0;4>c;c++)document.getElementById("2-"+c).classList.add("moving"),
document.getElementById("2-"+c).classList.add("cyan"),e[2][c]=1;l="st";break;case 1:case "sq":for(c=0;2>c;c++)document.getElementById("2-"+c).classList.add("moving"),document.getElementById("2-"+c).classList.add("yellow"),e[2][c]=1;for(c=0;2>c;c++)document.getElementById("3-"+c).classList.add("moving"),document.getElementById("3-"+c).classList.add("yellow"),e[3][c]=1;l="sq";break;case 2:case "rl":for(c=0;3>c;c++)document.getElementById("2-"+c).classList.add("moving"),document.getElementById("2-"+
c).classList.add("orange"),e[2][c]=1;document.getElementById("3-2").classList.add("moving");document.getElementById("3-2").classList.add("orange");e[3][2]=1;l="rl";break;case 3:case "tt":for(c=0;3>c;c++)document.getElementById("2-"+c).classList.add("moving"),document.getElementById("2-"+c).classList.add("blue"),e[2][c]=1;document.getElementById("1-1").classList.add("moving");document.getElementById("1-1").classList.add("blue");e[1][1]=1;l="tt";break;case 4:case "ml":for(c=0;3>c;c++)document.getElementById("2-"+
c).classList.add("moving"),document.getElementById("2-"+c).classList.add("green"),e[2][c]=1;document.getElementById("1-2").classList.add("moving");document.getElementById("1-2").classList.add("green");e[1][2]=1;l="ml";break;case 5:case "rz":for(c=0;2>c;c++)document.getElementById("2-"+c).classList.add("moving"),document.getElementById("2-"+c).classList.add("purple"),e[2][c]=1;for(c=0;2>c;c++)document.getElementById("3-"+(c+1)).classList.add("moving"),document.getElementById("3-"+(c+1)).classList.add("purple"),
e[3][c+1]=1;l="rz";break;case 6:case "mz":for(c=0;2>c;c++)document.getElementById("2-"+c).classList.add("moving"),document.getElementById("2-"+c).classList.add("red"),e[2][c]=1;for(c=0;2>c;c++)document.getElementById("1-"+(c+1)).classList.add("moving"),document.getElementById("1-"+(c+1)).classList.add("red"),e[1][c+1]=1;l="mz"}m=!1;n=!0;F()}},oa=function(a){if(0===a)return 0!==e[2][0]||0!==e[2][1]||0!==e[2][2]||0!==e[2][3];if(1===a)return 0!==e[2][0]||0!==e[2][1]||0!==e[3][0]||0!==e[3][1];if(2===
a)return 0!==e[2][0]||0!==e[2][1]||0!==e[2][2]||0!==e[3][2];if(3===a)return 0!==e[2][0]||0!==e[2][1]||0!==e[2][2]||0!==e[1][1];if(4===a)return 0!==e[2][0]||0!==e[2][1]||0!==e[2][2]||0!==e[1][2];if(5===a)return 0!==e[2][0]||0!==e[2][1]||0!==e[3][1]||0!==e[3][2];if(6===a)return 0!==e[2][0]||0!==e[2][1]||0!==e[1][1]||0!==e[1][2]},ma=function(){var a=u();if(pa(a))n=!1,p=!0;else{var b=[];a.forEach(function(a){var c=$jscomp.makeIterator(r(a.id));a=c.next().value;c=c.next().value;document.getElementById(a+
"-"+c).classList.remove("moving");e[a][c]=0;b.push([a,c])});b.forEach(function(a){document.getElementById(a[0]+"-"+(a[1]+1)).classList.add("moving");e[a[0]][a[1]+1]=1;N(document.getElementById(a[0]+"-"+a[1]),document.getElementById(a[0]+"-"+(a[1]+1)),"moving")});F()}},aa=function(){I();var a=[];for(u().forEach(function(b){var c=$jscomp.makeIterator(r(b.id));b=c.next().value;c=c.next().value;a.push([b,c])});X(a);)a.forEach(function(a){a[1]+=1});qa(a);E=!1},qa=function(a){K();a.forEach(function(a){var b=
document.getElementById(a[0]+"-"+a[1]);b.classList.add("moving");e[a[0]][a[1]]=1;switch(l){case "st":b.classList.add("cyan");break;case "sq":b.classList.add("yellow");break;case "rl":b.classList.add("orange");break;case "tt":b.classList.add("blue");break;case "ml":b.classList.add("green");break;case "rz":b.classList.add("purple");break;case "mz":b.classList.add("red")}})},pa=function(a){var b=!1;a.forEach(function(a){var c=$jscomp.makeIterator(r(a.id));a=c.next().value;c=c.next().value;if(19===c||
2===e[a][c+1])b=!0});return b},na=function(){u().forEach(function(a){a.classList.remove("moving");a.classList.add("placed");var b=$jscomp.makeIterator(r(a.id));a=b.next().value;b=b.next().value;e[a][b]=2});la();p=!1;m=!0;f=1},r=function(a){a=a.split("-");return[Number(a[0]),Number(a[1])]},B=function(a){a.classList.contains("blue")?a.classList.remove("blue"):a.classList.contains("red")?a.classList.remove("red"):a.classList.contains("yellow")?a.classList.remove("yellow"):a.classList.contains("green")?
a.classList.remove("green"):a.classList.contains("cyan")?a.classList.remove("cyan"):a.classList.contains("purple")?a.classList.remove("purple"):a.classList.contains("orange")&&a.classList.remove("orange")},ka=function(a,b){var c=document.getElementById(a+"-"+b),d=document.getElementById(a+"-"+(b-1));B(c);if(d.classList.contains("blue"))return"blue";if(d.classList.contains("red"))return"red";if(d.classList.contains("yellow"))return"yellow";if(d.classList.contains("green"))return"green";if(d.classList.contains("cyan"))return"cyan";
if(d.classList.contains("purple"))return"purple";if(d.classList.contains("orange"))return"orange"},N=function(a,b,c){a.classList.contains("blue")?(b.classList.add("blue"),a.classList.contains(c)||a.classList.remove("blue")):a.classList.contains("red")?(b.classList.add("red"),a.classList.contains(c)||a.classList.remove("red")):a.classList.contains("yellow")?(b.classList.add("yellow"),a.classList.contains(c)||a.classList.remove("yellow")):a.classList.contains("green")?(b.classList.add("green"),a.classList.contains(c)||
a.classList.remove("green")):a.classList.contains("cyan")?(b.classList.add("cyan"),a.classList.contains(c)||a.classList.remove("cyan")):a.classList.contains("purple")?(b.classList.add("purple"),a.classList.contains(c)||a.classList.remove("purple")):a.classList.contains("orange")&&(b.classList.add("orange"),a.classList.contains(c)||a.classList.remove("orange"))},ra=function(){var a=document.getElementById("ctrlList"),b=document.getElementById("hideBtn");a.classList.contains("hidden")?(a.classList.remove("hidden"),
b.textContent="Hide"):(a.classList.add("hidden"),b.textContent="Show")},I=function(){Array.from(document.querySelectorAll(".flashOn")).forEach(function(a){a.classList.remove("flashOn")})},X=function(a){a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if(b=b.value,19===b[1]||2===e[b[0]][b[1]+1])return!1;return!0},F=function(){if(n){var a=[],b=[];u().forEach(function(c){var d=$jscomp.makeIterator(r(c.id));c=d.next().value;d=d.next().value;a.push([c,d]);b.push([c,d])});for(var c=0,d=$jscomp.makeIterator(a),
e=d.next();!e.done;e=d.next())e=e.value,e[1]>c&&(c=e[1]);for(;X(a);)a.forEach(function(a){a[1]+=1});sa(b,a)?I():(I(),a.forEach(function(a){document.getElementById(a[0]+"-"+a[1]).firstChild.classList.add("flashOn")}))}},sa=function(a,b){for(var c=$jscomp.makeIterator(a),d=c.next();!d.done;d=c.next())for(var d=d.value,e=$jscomp.makeIterator(b),f=e.next();!f.done;f=e.next())if(f=f.value,d[0]==f[0]&&d[1]==f[1])return!0;return!1};(function(){for(var a=0;10>a;a++){var b=document.createElement("div");b.id=
"col-"+a;b.classList.add("col");Y.appendChild(b);e.push([]);for(var c=0;20>c;c++){var d=document.createElement("div");d.id=a+"-"+c;d.classList.add("cell");b.appendChild(d);e[a].push(0);var f=document.createElement("div");f.id="f"+a+"-"+c;f.classList.add("flash");d.appendChild(f)}}b=document.getElementById("nextPeice");a=document.getElementById("heldPeice");for(c=0;4>c;c++)for(d=document.createElement("div"),d.id="col-"+c+"-n",d.classList.add("col"),b.appendChild(d),f=0;4>f;f++){var h=document.createElement("div");
h.id=c+"-"+f+"-n";h.classList.add("cell");d.appendChild(h)}for(b=0;4>b;b++)for(c=document.createElement("div"),c.id="col-"+b+"-h",c.classList.add("col"),a.appendChild(c),d=0;4>d;d++)f=document.createElement("div"),f.id=b+"-"+d+"-h",f.classList.add("cell"),c.appendChild(f);document.getElementById("startBtn").addEventListener("click",ja);document.addEventListener("keydown",ba);document.addEventListener("keyup",ia);document.getElementById("hideBtn").addEventListener("click",ra);document.getElementById("points").textContent=
q;document.getElementById("highPoints").textContent=0<G?G:" No High Score";window.onkeydown=function(a){return!((" "===a.key||"ArrowUp"===a.key||"ArrowDown"===a.key)&&a.target==document.body)}})()})();
